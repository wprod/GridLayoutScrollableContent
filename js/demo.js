"use strict";function _instanceof(left,right){if(right!=null&&typeof Symbol!=="undefined"&&right[Symbol.hasInstance]){return right[Symbol.hasInstance](left)}else{return left instanceof right}}
function _classCallCheck(instance,Constructor){if(!_instanceof(instance,Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}
{var getOffset=function getOffset(elem,axis){var offset=0;var type=axis==='top'?'offsetTop':'offsetLeft';do{if(!isNaN(elem[type])){offset+=elem[type]}}while(elem=elem.offsetParent);return offset};var distance=function distance(p1,p2){return Math.hypot(p2.x-p1.x,p2.y-p1.y)};var randNumber=function randNumber(min,max){return Math.floor(Math.random()*(max-min+1))+min};var getMousePos=function getMousePos(e){var posx=0;var posy=0;if(!e)e=window.event;if(e.pageX||e.pageY){posx=e.pageX;posy=e.pageY}else if(e.clientX||e.clientY){posx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;posy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop}
return{x:posx,y:posy}};var getAngle=function getAngle(el){var st=window.getComputedStyle(el,null);var tr=st.getPropertyValue('transform');var values=tr.split('(')[1];values=values.split(')')[0];values=values.split(',');return Math.round(Math.asin(values[1])*(180/Math.PI))};var keys={37:1,38:1,39:1,40:1};var preventDefault=function preventDefault(e){e=e||window.event;if(e.preventDefault)e.preventDefault();e.returnValue=!1};var preventDefaultForScrollKeys=function preventDefaultForScrollKeys(e){if(keys[e.keyCode]){preventDefault(e);return!1}};var disableScroll=function disableScroll(){if(window.addEventListener)
window.addEventListener('DOMMouseScroll',preventDefault,!1);window.onwheel=preventDefault;window.onmousewheel=document.onmousewheel=preventDefault;window.ontouchmove=preventDefault;document.onkeydown=preventDefaultForScrollKeys};var enableScroll=function enableScroll(){if(window.removeEventListener)window.removeEventListener('DOMMouseScroll',preventDefault,!1);window.onmousewheel=document.onmousewheel=null;window.onwheel=null;window.ontouchmove=null;document.onkeydown=null};var GridItem=function(){function GridItem(el){_classCallCheck(this,GridItem);this.DOM={el:el};this.DOM.bg=this.DOM.el.querySelector('.grid__item-bg');this.DOM.tilt={};this.DOM.imgWrap=this.DOM.el.querySelector('.grid__item-wrap');this.DOM.tilt.img=this.DOM.imgWrap.querySelector('img');this.DOM.tilt.title=this.DOM.el.querySelector('.grid__item-title');this.DOM.tilt.number=this.DOM.el.querySelector('.grid__item-number');charming(this.DOM.tilt.number);this.DOM.numberLetters=this.DOM.tilt.number.querySelectorAll('span');this.tiltconfig={title:{translation:{x:[-8,8],y:[4,-4]}},number:{translation:{x:[-5,5],y:[-10,10]}},img:{translation:{x:[-15,15],y:[-10,10]}}};this.angle=getAngle(this.DOM.tilt.img);this.initEvents()}
_createClass(GridItem,[{key:"initEvents",value:function initEvents(){var _this=this;this.toggleAnimationOnHover=function(type){TweenMax.to(_this.DOM.bg,1,{ease:Expo.easeOut,scale:type==='mouseenter'?1.15:1});_this.DOM.numberLetters.forEach(function(letter,pos){TweenMax.to(letter,.2,{ease:Quad.easeIn,delay:pos*.1,y:type==='mouseenter'?'-50%':'50%',opacity:0,onComplete:function onComplete(){TweenMax.to(letter,type==='mouseenter'?0.6:1,{ease:type==='mouseenter'?Expo.easeOut:Elastic.easeOut.config(1,0.4),startAt:{y:type==='mouseenter'?'70%':'-70%',opacity:0},y:'0%',opacity:1})}})})};this.mouseenterFn=function(ev){if(!allowTilt)return;_this.toggleAnimationOnHover(ev.type)};this.mousemoveFn=function(ev){return requestAnimationFrame(function(){if(!allowTilt)return;_this.tilt(ev)})};this.mouseleaveFn=function(ev){if(!allowTilt)return;_this.resetTilt();_this.toggleAnimationOnHover(ev.type)};this.DOM.el.addEventListener('mouseenter',this.mouseenterFn);this.DOM.el.addEventListener('mousemove',this.mousemoveFn);this.DOM.el.addEventListener('mouseleave',this.mouseleaveFn)}},{key:"tilt",value:function tilt(ev){var mousepos=getMousePos(ev);var docScrolls={left:body.scrollLeft+docEl.scrollLeft,top:body.scrollTop+docEl.scrollTop};var bounds=this.DOM.el.getBoundingClientRect();var relmousepos={x:mousepos.x-bounds.left-docScrolls.left,y:mousepos.y-bounds.top-docScrolls.top};for(var key in this.DOM.tilt){var t=this.tiltconfig[key].translation;TweenMax.to(this.DOM.tilt[key],2,{ease:Expo.easeOut,x:(t.x[1]-t.x[0])/bounds.width*relmousepos.x+t.x[0],y:(t.y[1]-t.y[0])/bounds.height*relmousepos.y+t.y[0]})}}},{key:"resetTilt",value:function resetTilt(){for(var key in this.DOM.tilt){TweenMax.to(this.DOM.tilt[key],2,{ease:Elastic.easeOut.config(1,0.4),x:0,y:0})}}},{key:"hide",value:function hide(){var withAnimation=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0;this.toggle(withAnimation,!1)}},{key:"show",value:function show(){var withAnimation=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0;this.toggle(withAnimation)}},{key:"toggle",value:function toggle(withAnimation){var show=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;TweenMax.to(this.DOM.tilt.img,withAnimation?0.8:0,{ease:Expo.easeInOut,delay:!withAnimation?0:show?0.15:0,scale:show?1:0,opacity:show?1:0});TweenMax.to(this.DOM.bg,withAnimation?0.8:0,{ease:Expo.easeInOut,delay:!withAnimation?0:show?0:0.15,scale:show?1:0,opacity:show?1:0});this.toggleTexts(show?0.45:0,withAnimation,show)}},{key:"hideTexts",value:function hideTexts(){var delay=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var withAnimation=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.toggleTexts(delay,withAnimation,!1)}},{key:"showTexts",value:function showTexts(){var delay=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var withAnimation=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.toggleTexts(delay,withAnimation)}},{key:"toggleTexts",value:function toggleTexts(delay,withAnimation){var show=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;TweenMax.to([this.DOM.tilt.title,this.DOM.tilt.number],!withAnimation?0:show?1:0.5,{ease:show?Expo.easeOut:Quart.easeIn,delay:!withAnimation?0:delay,y:show?0:20,opacity:show?1:0})}}]);return GridItem}();var Content=function(){function Content(el){_classCallCheck(this,Content);this.DOM={el:el};this.DOM.img=this.DOM.el.querySelector('.content__item-img');this.DOM.title=this.DOM.el.querySelector('.content__item-title');charming(this.DOM.title);this.DOM.titleLetters=this.DOM.title.querySelectorAll('span');this.titleLettersTotal=this.DOM.titleLetters.length}
_createClass(Content,[{key:"show",value:function show(){var delay=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var withAnimation=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.toggle(delay,withAnimation)}},{key:"hide",value:function hide(){var delay=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var withAnimation=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.toggle(delay,withAnimation,!1)}},{key:"toggle",value:function toggle(delay,withAnimation){var _this2=this;var show=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;setTimeout(function(){_this2.DOM.titleLetters.forEach(function(letter,pos){TweenMax.to(letter,!withAnimation?0:show?.6:.3,{ease:show?Back.easeOut:Quart.easeIn,delay:!withAnimation?0:show?pos*.05:(_this2.titleLettersTotal-pos-1)*.04,startAt:show?{y:'50%',opacity:0}:null,y:show?'0%':'50%',opacity:show?1:0})})},withAnimation?delay*1000:0)}}]);return Content}();var Grid=function(){function Grid(el){var _this3=this;_classCallCheck(this,Grid);this.DOM={el:el};this.DOM.gridWrap=this.DOM.el.parentNode;this.items=[];Array.from(this.DOM.el.querySelectorAll('.grid__item')).forEach(function(itemEl){return _this3.items.push(new GridItem(itemEl))});this.itemsTotal=this.items.length;this.contents=[];Array.from(document.querySelectorAll('.content > .content__item')).forEach(function(contentEl){return _this3.contents.push(new Content(contentEl))});this.DOM.closeCtrl=document.querySelector('.content__close');this.DOM.scrollIndicator=document.querySelector('.content__indicator');this.current=-1;this.initEvents()}
_createClass(Grid,[{key:"initEvents",value:function initEvents(){var _this4=this;var _iteratorNormalCompletion=!0;var _didIteratorError=!1;var _iteratorError=undefined;try{var _loop=function _loop(){var item=_step.value;item.DOM.el.addEventListener('click',function(ev){ev.preventDefault();_this4.openItem(item)})};for(var _iterator=this.items[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){_loop()}}catch(err){_didIteratorError=!0;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}
this.DOM.closeCtrl.addEventListener('click',function(){return _this4.closeItem()});this.resizeFn=function(){if(_this4.current===-1||winsize.width===window.innerWidth)return;_this4.closeItem(!1)};window.addEventListener('resize',this.resizeFn)}},{key:"getSizePosition",value:function getSizePosition(el){var scrolls=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;var scrollTop=window.pageYOffset||docEl.scrollTop||body.scrollTop;var scrollLeft=window.pageXOffset||docEl.scrollLeft||body.scrollLeft;return{width:el.offsetWidth,height:el.offsetHeight,left:scrolls?getOffset(el,'left')-scrollLeft:getOffset(el,'left'),top:scrolls?getOffset(el,'top')-scrollTop:getOffset(el,'top')}}},{key:"openItem",value:function openItem(item){var _this5=this;if(this.isAnimating)return;this.isAnimating=!0;this.scrollPos=window.scrollY;disableScroll();allowTilt=!1;this.current=this.items.indexOf(item);this.hideAllItems(item);item.hideTexts();item.DOM.el.style.zIndex=1000;var itemDim=this.getSizePosition(item.DOM.el);item.DOM.bg.style.width="".concat(itemDim.width,"px");item.DOM.bg.style.height="".concat(itemDim.height,"px");item.DOM.bg.style.left="".concat(itemDim.left,"px");item.DOM.bg.style.top="".concat(itemDim.top,"px");item.DOM.bg.style.position='fixed';var d=Math.hypot(winsize.width,winsize.height);TweenMax.to(item.DOM.bg,1.2,{ease:Expo.easeInOut,delay:0.4,x:winsize.width/2-(itemDim.left+itemDim.width/2),y:winsize.height/2-(itemDim.top+itemDim.height/2),scaleX:d/itemDim.width,scaleY:d/itemDim.height,rotation:-1*item.angle*2});var contentEl=this.contents[this.current];contentEl.DOM.el.classList.add('content__item--current');var imgDim=this.getSizePosition(item.DOM.imgWrap);var contentImgDim=this.getSizePosition(contentEl.DOM.img,!1);this.showContentElems(contentEl,1);TweenMax.to(item.DOM.tilt.img,1.2,{ease:Expo.easeInOut,delay:0.55,scaleX:contentImgDim.width/imgDim.width,scaleY:contentImgDim.height/imgDim.height,x:contentImgDim.left+contentImgDim.width/2-(imgDim.left+imgDim.width/2),y:contentImgDim.top+contentImgDim.height/2-(imgDim.top+imgDim.height/2),rotation:0,onComplete:function onComplete(){item.DOM.tilt.img.style.opacity=0;contentEl.DOM.img.style.visibility='visible';_this5.DOM.gridWrap.classList.add('grid-wrap--hidden');window.scrollTo(0,0);enableScroll();_this5.isAnimating=!1}})}},{key:"closeItem",value:function closeItem(){var _this6=this;var withAnimation=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0;if(this.isAnimating)return;this.isAnimating=!0;var contentEl=this.contents[this.current];window.scrollTo(0,this.scrollPos);contentEl.DOM.el.parentNode.style.position='fixed';disableScroll();this.DOM.gridWrap.classList.remove('grid-wrap--hidden');var item=this.items[this.current];this.hideContentElems(contentEl,0,withAnimation);item.DOM.tilt.img.style.opacity=1;contentEl.DOM.img.style.visibility='hidden';TweenMax.to(item.DOM.tilt.img,withAnimation?1.2:0,{ease:Expo.easeInOut,scaleX:1,scaleY:1,x:0,y:0,rotation:item.angle*2});TweenMax.to(item.DOM.bg,withAnimation?1.2:0,{ease:Expo.easeInOut,delay:0.15,x:0,y:0,scaleX:1,scaleY:1,rotation:0,onComplete:function onComplete(){contentEl.DOM.el.classList.remove('content__item--current');item.DOM.bg.style.position='absolute';item.DOM.bg.style.left='0px';item.DOM.bg.style.top='0px';_this6.current=-1;allowTilt=!0;item.DOM.el.style.zIndex=0;enableScroll();_this6.isAnimating=!1}});this.showAllItems(item,withAnimation);item.showTexts(1,withAnimation)}},{key:"showContentElems",value:function showContentElems(contentEl){var delay=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var withAnimation=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;this.toggleContentElems(contentEl,delay,withAnimation)}},{key:"hideContentElems",value:function hideContentElems(contentEl){var delay=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var withAnimation=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;this.toggleContentElems(contentEl,delay,withAnimation,!1)}},{key:"toggleContentElems",value:function toggleContentElems(contentEl,delay,withAnimation){var show=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!0;TweenMax.to([this.DOM.closeCtrl,this.DOM.scrollIndicator],withAnimation?0.8:0,{ease:show?Expo.easeOut:Expo.easeIn,delay:withAnimation?delay:0,startAt:show?{y:60}:null,y:show?0:60,opacity:show?1:0});if(show){contentEl.show(delay,withAnimation)}else{contentEl.hide(delay,withAnimation)}}},{key:"sortByDist",value:function sortByDist(refPoint,itemsArray){var distancePairs=[];var output=[];for(var i in itemsArray){var rect=itemsArray[i].DOM.el.getBoundingClientRect();distancePairs.push([distance(refPoint,{x:rect.left+rect.width/2,y:rect.top+rect.height/2}),i])}
distancePairs.sort(function(a,b){return a[0]-b[0]});for(var p in distancePairs){var pair=distancePairs[p];output.push(itemsArray[pair[1]])}
return output}},{key:"showAllItems",value:function showAllItems(exclude){var withAnimation=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.toggleAllItems(exclude,withAnimation)}},{key:"hideAllItems",value:function hideAllItems(exclude){var withAnimation=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.toggleAllItems(exclude,withAnimation,!1)}},{key:"toggleAllItems",value:function toggleAllItems(exclude,withAnimation){var show=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;if(!withAnimation){this.items.filter(function(item){return item!=exclude}).forEach(function(item,pos){return item[show?'show':'hide'](withAnimation)})}else{var refrect=exclude.DOM.el.getBoundingClientRect();var refPoint={x:refrect.left+refrect.width/2,y:refrect.top+refrect.height/2};this.sortByDist(refPoint,this.items.filter(function(item){return item!=exclude})).forEach(function(item,pos){return setTimeout(function(){return item[show?'show':'hide']()},show?300+pos*70:pos*70)})}}}]);return Grid}();var allowTilt=!0;var body=document.body;var docEl=document.documentElement;var winsize;var calcWinsize=function calcWinsize(){return winsize={width:window.innerWidth,height:window.innerHeight}};calcWinsize();window.addEventListener('resize',calcWinsize);var grid=new Grid(document.querySelector('.grid'));imagesLoaded(document.querySelectorAll('.grid__item-img'),function(){body.classList.remove('loading');var msnry=new Masonry(grid.DOM.el,{itemSelector:'.grid__item',columnWidth:260,gutter:100,fitWidth:!0})})}